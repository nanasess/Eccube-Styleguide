# スタイルガイドの appRoot 設定の改善

## 課題

npm run build:styleguide:generate でスタイルガイドをビルドした際、appRoot が設定されていないため、JavaScript や CSS などのリソースが / からのパスとなってしまう問題がありました。

## 解決方法

1. 環境変数 `APP_ROOT` でappRootを指定できるようにする
2. `APP_ROOT` のデフォルト値は '' (空文字) とする
3. GitHub Actions でも `APP_ROOT=/Eccube-Styleguide/` を設定して、GitHub Pages で正しく表示されるようにする

## 実装内容

### 1. assets/gulp/styleguide.js の修正

```javascript
// appRoot の環境変数を取得、指定がなければデフォルトで空文字を設定
var appRoot = process.env.APP_ROOT || '';

// styelguideConfig に設定を追加
const styelguideConfig = {
    title: 'My Styleguide',
    rootPath: outputPath,
    overviewPath: './assets/styleguide.md',
    appRoot: appRoot, // appRoot の設定を追加
    // ...他の設定...
}
```

### 2. GitHub Actionsの設定

`.github/workflows/github_pages.yml` を修正して、デプロイ時に `APP_ROOT` 環境変数を設定:

```yaml
- name: Build styleguide
  run: APP_ROOT=/Eccube-Styleguide/ npm run build:styleguide
```

### 3. README.md に使用方法を追記

```markdown
### appRoot の設定

スタイルガイドをビルドする際、JavaScriptやCSSなどのリソースのパスに接頭辞を付けたい場合は、環境変数 `APP_ROOT` を使用できます。
これは特にサブディレクトリにデプロイする場合に便利です。

例えば、`/styleguide/` というパスにデプロイする場合：

```
$ APP_ROOT=/styleguide/ npm run build:styleguide:generate
```

`APP_ROOT` が指定されない場合、デフォルト値は空文字 (`''`) となります。

GitHub Actions でのデプロイ時にも `APP_ROOT=/Eccube-Styleguide/` が設定されており、GitHub Pages 上では適切なパスでリソースが読み込まれます。
```

## 動作確認

```bash
APP_ROOT=/Eccube-Styleguide/ npm run build:styleguide:generate
```

コマンドを実行後、生成された `public/index.html` を確認したところ、以下のようにパスが正しく設定されていることを確認しました：

```html
<link rel="icon" href="/Eccube-Styleguide//assets/img/favicon.ico">
<!-- その他のリソースも同様に /Eccube-Styleguide/ のパスで設定されている -->
```

これにより、GitHub Pages などのサブディレクトリにデプロイした場合でも正しくリソースが読み込まれるようになりました。
